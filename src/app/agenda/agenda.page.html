<ion-header style="--ion-background-color: #3880ff;">
    <ion-toolbar color="primary">
        <ion-buttons slot="start">
            <ion-menu-button></ion-menu-button>
        </ion-buttons>
        <ion-title>
            Agenda
        </ion-title>
    </ion-toolbar>
</ion-header>
<ion-content class="fondoColor background">
    <ion-refresher slot="fixed" (ionRefresh)="actualizar($event)">
        <ion-refresher-content pullingText="Pull to refresh" refreshingSpinner="circles" refreshingText="Refreshing...">
        </ion-refresher-content>
    </ion-refresher>
    <ion-grid>
        <ion-row>
            <ion-col size="8" id="calendario" style="background-color: white;">
                <ion-row>
                    <div id="mes" style="width: 100%">
                        <ion-col size="1" class="boton-alinear">
                            <button style="background: #ffffff; color: black;" (click)="calendarDrop($event, 'left')">
                  <ion-icon name="arrow-back" size="large"></ion-icon>
                </button>
                        </ion-col>
                        <ion-col size="10" class="alinear">
                            <button style="width: 100%; background: #ffffff; color: black;" (click)="presentModalAnioMes()">
                  <h3 style="margin-top: 0px">{{ currentMonthStr }}</h3>
                </button>
                        </ion-col>
                        <ion-col size="1">
                            <button style="background: #ffffff; color: black;" (click)="calendarDrop($event, 'right')">
                  <ion-icon name="arrow-forward" size="large"></ion-icon>
                </button>
                        </ion-col>
                    </div>
                </ion-row>
                <calendar [currentDate]="calendar.currentDate" (onCurrentDateChanged)="elegirFecha1($event)" [startHour]="6" [endHour]="20" [step]="30" [startingDayWeek]="1" [showEventDetail]="false" id="tabla-calendario">
                </calendar>
            </ion-col>
            <ion-col size="4">
                <ion-row>
                    <ion-col>
                        <ion-item [ngClass]=" hour == null ? 'borde' : 'borde-seleccionado' ">
                            <ion-label>Hora</ion-label>
                            <ionic-selectable #hourSelect [(ngModel)]="hour" [items]="this.dataArray.hour" itemValueField="id" itemTextField="name" [canSearch]="true" groupValueField="time" groupTextField="time" (onChange)="comboChange($event, 'hour')" (onClear)="limpiarFiltro($event, 'hour')"
                                [clearButtonText]="'Limpiar'" [canClear]="true">
                            </ionic-selectable>
                        </ion-item>
                    </ion-col>
                </ion-row>
                <ion-row>
                    <ion-col>
                        <ion-item [ngClass]=" doctor == null ? 'borde' : 'borde-seleccionado' ">
                            <ion-label>Doctor</ion-label>
                            <ionic-selectable #doctorSelect [(ngModel)]="doctor" [items]="this.dataArray.doctor" itemValueField="id" itemTextField="name" [canSearch]="true" (onChange)="comboChange($event, 'doctor')" (onClear)="limpiarFiltro($event, 'doctor')" [clearButtonText]="'Limpiar'"
                                [canClear]="true">
                            </ionic-selectable>
                        </ion-item>
                    </ion-col>
                </ion-row>
                <ion-row>
                    <ion-col>
                        <ion-item [hidden]="this.doctor === undefined" [ngClass]=" sucursal == null ? 'borde' : 'borde-seleccionado' ">
                            <ion-label>Sucursal</ion-label>
                            <ionic-selectable #sucursalSelect [(ngModel)]="sucursal" [items]="this.dataArray.sucursal" itemValueField="id" itemTextField="name" [canSearch]="true" (onChange)="comboChange($event, 'sucursal')" (onClear)="limpiarFiltro($event, 'sucursal')" [clearButtonText]="'Limpiar'"
                                [canClear]="true">
                            </ionic-selectable>
                        </ion-item>
                    </ion-col>
                </ion-row>
                <ion-row>
                    <ion-col size="6">
                        <ion-button (click)="resetFilters()">Reiniciar Filtros</ion-button>
                    </ion-col>
                    <ion-col size="6">
                        <ion-button (click)="buscarDisponibles()" color="success" [disabled]="this.doctor === undefined || this.sucursal === undefined">Citas Disponibles</ion-button>
                    </ion-col>
                </ion-row>
            </ion-col>
        </ion-row>
        <ion-row>
        </ion-row>
    </ion-grid>
    <lista-agenda [hidden]="this.sucursal === undefined" #listaAgenda [filtros]="filterObj" [fecha]="fecha1" [horariosSabados]="paramHorariosSabados" [listaDoctores]="todosLosDoctores"></lista-agenda>
</ion-content>